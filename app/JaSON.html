<!DOCTYPE html>

<!--
   Copyright 2015 Shane Bell

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
 -->

<html ng-app="JaSON">

<head>

	<title>JaSON</title>

	<!-- jquery -->
	<script src="/lib/jquery/jquery.js" type="text/javascript"></script>

	<!-- lodash -->
	<script src="/lib/lodash/lodash.compat.js" type="text/javascript"></script>

	<!-- moment -->
	<script src="/lib/moment/moment.js" type="text/javascript"></script>

	<!-- JSON5 -->
	<script src="/lib/json5/lib/json5.js" type="text/javascript"></script>

	<!-- pouchdb -->
	<script src="/lib/pouchdb/pouchdb.js" type="text/javascript"></script>

	<!-- highlightjs -->
	<script src="/lib/highlightjs/highlight.pack.js" type="text/javascript"></script>
	<link href="/lib/highlightjs/default.css" rel="stylesheet">

	<!-- bootstrap -->
	<link href="/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">

	<!-- angular -->
	<script src="/lib/angular/angular.js" type="text/javascript"></script>
	<link href="/lib/angular/angular-csp.css" rel="stylesheet">

	<!-- angular libs-->
	<script src="/lib/angular-moment/angular-moment.js" type="text/javascript"></script>
	<script src="/lib/angular-bootstrap/ui-bootstrap-tpls.js" type="text/javascript"></script>
	<script src="/lib/angular-highlightjs/angular-highlightjs.js" type="text/javascript"></script>

	<!-- JaSON -->
	<script src="/scripts/app.js" type="text/javascript"></script>
	<script src="/scripts/services/HttpService.js" type="text/javascript"></script>
	<script src="/scripts/services/HistoryService.js" type="text/javascript"></script>
	<script src="/scripts/controllers/NavigationController.js" type="text/javascript"></script>
	<script src="/scripts/controllers/MainController.js" type="text/javascript"></script>
	<script src="/scripts/controllers/HistoryController.js" type="text/javascript"></script>
	<link href="/css/JaSON.css" rel="stylesheet">

</head>

<body>

<!-- Navbar -->
<div class="navbar navbar-default navbar-fixed-top" ng-controller="NavigationController">
	<div class="container-fluid">
		<div class="navbar-header">
			<a class="navbar-brand" href="#"><img src="images/icon-48x48.png"/>JaSON</a>
		</div>
		<div class="navbar-collapse collapse">
			<ul class="nav navbar-nav navbar-right">
				<li>
					<a href="#" ng-click="about()">About</a>
				</li>
			</ul>
		</div>
	</div>
</div>

<!-- Container -->
<div class="container-fluid main" ng-controller="MainController">

	<div class="row">

		<!-- left column (HTTP request details and history) -->
		<div class="col-lg-4">

			<div class="row">

				<div class="col-lg-12">

					<tabset id="request-tabs">

						<!-- Request details (url, method etc) -->
						<tab heading="HTTP request details" id="request-details">

							<div class="row">

								<!-- Request URL -->
								<div class="col-lg-12">
									<div class="form-group">
										<input type="text" id="url" class="form-control" placeHolder="http://www.example.com/service.json" ng-model="model.url"/>
										<span id="url-error" class="help-block hidden">URL is required.</span>
									</div>
								</div>

								<!-- Request method -->
								<div class="col-lg-12">
									<div class="form-group">
										<select id="method" class="form-control" ng-model="model.httpMethod" ng-options="httpMethod for httpMethod in httpMethods"></select>
									</div>
								</div>

								<!-- Content type -->
								<div class="col-lg-12">
									<div class="form-group">
										<select id="content-type" class="form-control" ng-model="model.contentType" ng-options="contentType.value as contentType.name for contentType in contentTypes"></select>
									</div>
								</div>
							</div>

							<!-- Headers -->
							<div class="row">
								<div class="col-lg-12">
									<a href="#" ng-click="addHeader()" id="add-header-action">
										<span class="glyphicon glyphicon-plus"></span> Add request header
									</a>
									<table id="request-headers" class="table table-condensed">
										<tbody>
										<tr ng-repeat="header in model.headers track by $index">
											<td>
												<input type="text" class="name form-control input-sm" placeHolder="name" ng-model="header.name"/>
											</td>
											<td>
												<input type="text" class="value form-control input-sm" placeHolder="value" ng-model="header.value"/>
											</td>
											<td>
												<a href="#" ng-click="removeHeader(header)">
													<span class="glyphicon glyphicon-remove"></span>
												</a>
											</td>
										</tr>
										</tbody>
									</table>
								</div>
							</div>

						</tab>

						<tab heading="History">
							<div ng-controller="HistoryController" id="request-history">

								<div class="history-controls">
									<a href="#" ng-click="clearHistory()" class="pull-right">Clear</a>
									<h3 class="panel-title">
										<span class="glyphicon glyphicon-time"></span> Request history
									</h3>
								</div>

								<table class="table table-hover">
									<tbody>
									<tr ng-repeat="entry in model.history track by $index" ng-if="model.history.length > 0">
										<td class="method">
											<span class="label" ng-class="{ 'label-primary': entry.method == 'POST', 'label-danger': entry.method == 'DELETE', 'label-warning': entry.method == 'PUT' }">{{ entry.method }}</span>
										</td>
										<td class="url">
											{{ entry.url }}
										</td>
										<td class="content-type">
									<span class="label pull-right" ng-class="{ 'label-primary': entry.contentType == 'application/json', 'label-info': entry.contentType == 'application/xml' }">
										JSON
									</span>
										</td>
									</tr>
									</tbody>
								</table>

							</div>
						</tab>

					</tabset>

				</div>

			</div>

			<!-- Action buttons -->
			<div class="row">
				<div class="col-lg-12">
					<div class="form-group">
						<button class="btn btn-primary" ng-click="sendRequest()">Send request <span class="glyphicon glyphicon-send" aria-hidden="true"></span></button>
						<button class="btn btn-default" ng-click="resetFields()">Reset fields</button>
						<img id="loading" src="images/loading.gif" ng-if="loading"/>
					</div>
				</div>
			</div>

		</div>

		<!-- Right column (HTTP request body and response data) -->
		<div class="col-lg-8">

			<!-- Request body -->
			<div class="row">
				<div class="col-lg-12" id="request-body">
					<div id="request-body-group" class="form-group">
						<textarea class="form-control col-lg-12" rows="10" placeholder="{{ requestBodyPlaceholder }}" ng-model="model.requestBody" ng-disabled="!requestBodyAllowed()"></textarea>
						<span id="request-body-error" class="help-block" style="display:none;"></span>
					</div>
				</div>
			</div>

			<!-- Response tabs -->
			<div class="row">
				<div class="col-lg-12">
					<tabset id="response-tabs">
						<div id="response-status">
							<span class="label label-success" ng-if="model.response.status">{{ model.response.status }} {{ responseCodes[model.response.status] }}</span>
							<span class="label label-info" ng-if="model.response.time">{{ model.response.time }}ms</span>
						</div>

						<tab heading="Response">
							<div hljs ng-if="model.response.data" source="model.response.data | json"></div>
						</tab>
						<tab heading="Raw response">
							<pre ng-if="model.response.data">{{model.response.data}}</pre>
						</tab>
						<tab heading="Response headers">
							<table class="table table-condensed" ng-if="model.response.headers">
								<tbody>
								<tr ng-repeat="(name, value) in model.response.headers track by $index">
									<td>{{ name }}</td>
									<td><code>{{ value }}</code></td>
								</tr>
								</tbody>
							</table>
						</tab>
					</tabset>
				</div>
			</div>

		</div>

	</div>


</div><!-- End container-fluid -->

</body>

</html>
