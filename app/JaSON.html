<!DOCTYPE html>

<!--
   Copyright 2015 Shane Bell

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
 -->

<html ng-app="JaSON">

<head>

	<title>JaSON</title>

	<!-- JQUERY -->
	<script src="/lib/jquery/jquery.js" type="text/javascript"></script>

	<!-- LODASH -->
	<script src="/lib/lodash/lodash.js" type="text/javascript"></script>

	<!-- MOMENT -->
	<script src="/lib/moment/moment.js" type="text/javascript"></script>

	<!-- JSON5 -->
	<script src="/lib/json5/lib/json5.js" type="text/javascript"></script>

	<!-- HIGHLIGHTJS -->
	<script src="/lib/highlightjs/highlight.pack.js" type="text/javascript"></script>
	<link href="/lib/highlightjs/default.css" rel="stylesheet">

	<!-- BOOTSTRAP -->
	<link href="/lib/bootstrap/bootstrap.css" rel="stylesheet">

	<!-- FONT AWESOME -->
	<link href="/lib/font-awesome/css/font-awesome.css" rel="stylesheet">

	<!-- ANGULAR -->
	<script src="/lib/angular/angular.js" type="text/javascript"></script>

	<!-- ANGULAR LIBS-->
	<script src="/lib/angular-bootstrap/ui-bootstrap-tpls.js" type="text/javascript"></script>
	<script src="/lib/angular-highlightjs/angular-highlightjs.js" type="text/javascript"></script>
	<script src="/lib/angular-moment/angular-moment.js" type="text/javascript"></script>

	<!-- JASON -->
	<script src="/scripts/app.js" type="text/javascript"></script>
	<script src="/scripts/services/httpService.js" type="text/javascript"></script>
	<script src="/scripts/services/historyService.js" type="text/javascript"></script>
	<script src="/scripts/controllers/navController.js" type="text/javascript"></script>
	<script src="/scripts/controllers/appController.js" type="text/javascript"></script>
	<script src="/scripts/controllers/historyController.js" type="text/javascript"></script>
	<link href="/css/JaSON.css" rel="stylesheet">

</head>

<body>

<!-- NAVBAR -->
<div class="navbar navbar-default navbar-fixed-top" ng-controller="navController as ctrl">
	<div class="container-fluid">
		<div class="navbar-header">
			<a class="navbar-brand" href="#">
				<img src="images/icon-48x48.png"/>
			</a>
			<div class="title">JaSON</div>
		</div>
		<div class="navbar-collapse collapse">
			<ul class="nav navbar-nav navbar-right">
				<li>
					<a href="#" ng-click="ctrl.about()">About</a>
				</li>
			</ul>
		</div>
	</div>
</div>

<!-- MAIN CONTAINER -->
<div class="container-fluid main" ng-controller="appController as ctrl">

	<div class="row">

		<!-- LEFT COLUMN (HTTP REQUEST DETAILS AND HISTORY) -->
		<div class="col-lg-4">

			<uib-tabset id="request-tabs">

				<!-- HTTP REQUEST DETAILS TAB -->
				<uib-tab>

					<uib-tab-heading>
						<i class="fa fa-random" aria-hidden="true"></i>
						HTTP request details
					</uib-tab-heading>

					<div class="row">

						<!-- REQUEST URL -->
						<div class="col-lg-12">
							<div class="form-group">
								<input type="text" id="url" class="form-control" placeHolder="http://www.example.com/service.json" ng-model="ctrl.model.url"/>
								<span id="url-error" class="help-block hidden">URL is required.</span>
							</div>
						</div>

						<!-- REQUEST METHOD -->
						<div class="col-lg-12">
							<div class="form-group">
								<select id="method" class="form-control" ng-model="ctrl.model.httpMethod" ng-options="httpMethod for httpMethod in ctrl.httpMethods"></select>
							</div>
						</div>

						<!-- CONTENT TYPE -->
						<div class="col-lg-12">
							<div class="form-group">
								<select id="content-type" class="form-control" ng-model="ctrl.model.contentType" ng-options="contentType.value as contentType.name for contentType in ctrl.contentTypes"></select>
							</div>
						</div>
					</div>

					<!-- HTTP HEADERS -->
					<div class="row">
						<div class="col-lg-12">
							<a href="#" ng-click="ctrl.addHeader()" id="add-header-action">
								<i class="fa fa-plus" aria-hidden="true"></i> Add request header
							</a>
							<table id="request-headers" class="table table-condensed">
								<tbody>
								<tr ng-repeat="header in ctrl.model.headers track by $index">
									<td>
										<input type="text" class="name form-control input-sm" placeHolder="name" ng-model="header.name"/>
									</td>
									<td>
										<input type="text" class="value form-control input-sm" placeHolder="value" ng-model="header.value"/>
									</td>
									<td>
										<a href="#" ng-click="ctrl.removeHeader(header)">
											<i class="fa fa-times" aria-hidden="true"></i>
										</a>
									</td>
								</tr>
								</tbody>
							</table>
						</div>
					</div>

				</uib-tab>


				<!-- REQUEST HISTORY TAB -->
				<uib-tab>

					<uib-tab-heading>
						<i class="fa fa-history" aria-hidden="true"></i>
						Request history
					</uib-tab-heading>

					<div ng-controller="historyController as ctrl">

						<div class="history-controls">
							<a href="#" ng-click="ctrl.clearHistory()" class="pull-right">Clear</a>
						</div>

						<table class="table table-hover">
							<tbody>
							<tr ng-repeat="entry in ctrl.model.history track by $index" ng-if="ctrl.model.history.length > 0">
								<td class="method">
									<span class="label" ng-class="{ 'label-primary': entry.method == 'POST', 'label-danger': entry.method == 'DELETE', 'label-warning': entry.method == 'PUT' }">{{ entry.method }}</span>
								</td>
								<td class="url">
									{{ entry.url }}
								</td>
								<td class="content-type">
									<span class="label pull-right" ng-class="{ 'label-primary': entry.contentType == 'application/json', 'label-info': entry.contentType == 'application/xml' }">
										JSON
									</span>
								</td>
							</tr>
							</tbody>
						</table>

					</div>

				</uib-tab>

			</uib-tabset>


			<!-- ACTION BUTTONS -->
			<div class="row">
				<div class="col-lg-12">
					<div class="form-group">
						<button class="btn btn-primary" ng-click="ctrl.sendRequest()" ng-disabled="ctrl.loading">
							Send request <i class="fa fa-paper-plane" aria-hidden="true"></i>
						</button>
						<button class="btn btn-default" ng-click="ctrl.resetFields()" ng-disabled="ctrl.loading">
							Reset fields
						</button>
						<img id="loading" src="images/loading.gif" ng-show="ctrl.loading"/>
					</div>
				</div>
			</div>

		</div>

		<!-- RIGHT COLUMN (HTTP REQUEST BODY AND RESPONSE DATA) -->
		<div class="col-lg-8">

			<!-- REQUEST BODY -->
			<div class="row">
				<div class="col-lg-12" id="request-body">
					<div id="request-body-group" class="form-group">
						<textarea class="form-control col-lg-12" rows="10" placeholder="{{ ctrl.requestBodyPlaceholder }}" ng-model="ctrl.model.requestBody" ng-disabled="!ctrl.requestBodyAllowed()"></textarea>
						<span id="request-body-error" class="help-block" style="display:none;"></span>
					</div>
				</div>
			</div>

			<!-- RESPONSE TABS -->
			<div class="row">
				<div class="col-lg-12">

					<div id="response-status">
						<span class="label label-success" ng-if="ctrl.model.response.status">{{ ctrl.model.response.status }} ({{ ctrl.model.response.statusText }})</span>
						<span class="label label-info" ng-if="ctrl.model.response.time">{{ ctrl.model.response.time }}ms</span>
					</div>

					<uib-tabset id="response-tabs">

						<uib-tab heading="Response">
							<div hljs ng-if="ctrl.model.response.data" source="ctrl.model.response.data | json"></div>
						</uib-tab>

						<uib-tab heading="Raw response">
							<pre ng-if="ctrl.model.response.data">{{ ctrl.model.response.data }}</pre>
						</uib-tab>

						<uib-tab heading="Response headers">
							<table class="table table-condensed">
								<tbody>
								<tr ng-repeat="(name, value) in ctrl.model.response.headers() track by $index">
									<td>{{ name }}</td>
									<td><code>{{ value }}</code></td>
								</tr>
								</tbody>
							</table>
						</uib-tab>

					</uib-tabset>

				</div>
			</div>

		</div>

	</div>

</div><!-- END MAIN CONTAINER -->

</body>

</html>
